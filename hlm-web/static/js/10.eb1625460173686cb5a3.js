webpackJsonp([10],{1055:function(e,t,r){function a(e){r(1179)}var s=r(85)(r(1120),r(1287),a,"data-v-6e266b6d",null);e.exports=s.exports},1075:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(212);r.n(a);t.default={props:{limitNumber:{type:Number,default:9},dialogImageUrl:{type:String,default:""},fileList:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1}},methods:{uploadSectionFile:function(e){var t=this,r=(this.$cfg.userInfo.memberNoMerchant,e.file),a=new FormData;if(r.size/1024/1024>10)return this.$message({type:"error",message:"上传文件大小不能超过 10M"}),this.fileList=[],!1;a.append("uploadFile",r),this.$http.post("/api/upload/uploadHeadImage.do",a).then(function(e){1==e.data.result?(t.$message({type:"success",message:"上传成功"}),t.fileList.push(e.data.returnObject)):(t.$message({type:"error",message:e.data.errorMessage}),t.fileList=[])})},handleRemove:function(e,t){},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},exceedNum:function(e){this.$message({type:"danger",message:"最多上传"+this.limitNumber+"张图片"})}},beforeDestroy:function(){this.fileList=[]}}},1120:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(45),s=r.n(a),i=r(86),l=r(56),n=r(1203),o=r.n(n);r(174);t.default={components:{MoreImgUpload:o.a},data:function(){var e=this,t=function(t,r,a){e.fileList.length>0?a():a(new Error("请上传购买凭证"))};return{userInfo:l.a.get("userInfo"),uploadUrl:l.a.get("userInfo").uploadUrl,list:[],userType:"",daterange:[],currentPage:1,total:0,pageSize:10,activeName:"first",showReceipt:!1,serverlist:[],serverName:"",serverDetail:{},systemServerList:[],step:1,payaccount:{},serveCode:"",serviceCurrentPage:1,serviceTotal:0,servicePageSize:10,form:{payType:"WX",runingWater:"",serverType:"",payCount:"",payTime:"",sharePic:""},rules:{payType:[{required:!0,message:"请选择支付方式",trigger:"change"}],payCount:[{required:!0,message:"请输入支付金额",trigger:"blur"}],serverType:[{required:!0,message:"请选择购买服务",trigger:"change"}],sharePic:[{required:!0,validator:t,trigger:"change"}]},limitNumber:5,fileList:[],minExecuteTime:{disabledDate:function(e){return e.getTime()>Date.now()}}}},computed:s()({},r.i(i.c)({user_type:function(e){return e.appVuex.user_type}})),mounted:function(){this.cluesList(),console.log(this.userInfo)},methods:{handleCurrentChange:function(e){this.currentPage=e,this.cluesList()},handleServiceCurrentChange:function(e){this.serviceCurrentPage=e,this.acceptedList()},cluesList:function(){var e=this,t={start:(this.currentPage-1)*this.pageSize,limit:this.pageSize,merchantNo:this.userInfo.memberNoMerchant,shopNo:"",serverName:this.serverName};this.$http.post("/api/hx/shopserver/list.do",t).then(function(t){if(1==t.data.result){var r=t.data.returnObject;e.total=parseInt(r.total),e.list=r.rows}})},handleDetails:function(e,t){var r=this;this.showReceipt=!0;var a={serverCode:t.serverCode};this.$http.post("/api/hx/server/detail.do",a).then(function(e){1==e.data.result&&(r.serverDetail=e.data.returnObject)})},acceptedList:function(){var e=this,t={start:(this.serviceCurrentPage-1)*this.servicePageSize,limit:this.servicePageSize};this.$http.post("/api/hx/server/list.do",t).then(function(t){if(1==t.data.result){var r=t.data.returnObject,a=r.rows,s=r.total;e.systemServerList=a,e.serviceTotal=parseInt(s)}})},hurryBuy:function(e){var t=this;this.form.serverType=e.serverName,this.form.payCount=e.price/100,this.serveCode=e.code,this.step=2,this.$http.post("/api/hx/server/payaccount.do").then(function(e){1==e.data.result&&(t.payaccount=e.data.returnObject)})},nextStep:function(){this.step=3},saveSubmit:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return console.log("error submit!!"),!1;var a={shopNo:"",merchantNo:t.userInfo.memberNoMerchant,payType:t.form.payType,amount:100*t.form.payCount,serialNum:t.form.runingWater,payCert:t.fileList.join(","),memberNoGuid:t.userInfo.memberNoGuid,serveCode:t.serveCode,payTimeStr:t.form.payTime};t.$http.post("/api/hx/server/buy.do",a).then(function(r){1==r.data.result&&(t.$message({type:"success",message:"提交成功，请等待管理员审核",duration:2e3}),t.$refs[e].resetFields(),t.step=1,t.activeName="first",t.$router.push({path:"/OrderManage"}))})})},limitMoney_input:function(){for(var e=[["[^\\d\\.]+$",""],["\\.(\\d?)\\.+",".$1"],["^(\\d+\\.\\d{2}).+","$1"]],t=0;t<e.length;t++){var r=new RegExp(e[t][0]);this.form.payCount=this.form.payCount.replace(r,e[t][1])}},inpnumup:function(e){e.target.value=e.target.value.replace(/[^\d.]/g,""),e.target.value=e.target.value.replace(/^\./g,""),e.target.value=e.target.value.replace(/\.{2,}/g,"."),e.target.value=e.target.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")},handleClick:function(e){"first"==e.name?this.cluesList():(this.step=1,this.acceptedList())}}}},1138:function(e,t){},1179:function(e,t){},1203:function(e,t,r){function a(e){r(1138)}var s=r(85)(r(1075),r(1246),a,null,null);e.exports=s.exports},1246:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"MoreImgUpload"},[r("el-upload",{attrs:{action:"/api/upload/uploadHeadImage.do","list-type":"picture-card",accept:".jpg, .jpeg, .png, .bmp, .psd, .tga, .tiff","file-list":e.fileList,"http-request":e.uploadSectionFile,limit:e.limitNumber,"on-exceed":e.exceedNum,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[r("i",{staticClass:"el-icon-plus"})]),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]}},1287:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ChargeMoney"},[r("div",{},[r("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"我的服务",name:"first"}},[r("div",{staticClass:"searchForm"},[r("div",{staticClass:"title"},[r("i"),e._v(" "),r("span",[e._v("筛选查询")])]),e._v(" "),r("el-form",{staticClass:"clearfix",attrs:{"label-width":"120px"}},[r("div",{staticClass:"fSearch-2-2"},[r("el-form-item",{attrs:{size:"small",label:"服务名称："}},[r("el-input",{attrs:{placeholder:"请输入服务名称"},model:{value:e.serverName,callback:function(t){e.serverName=t},expression:"serverName"}})],1)],1),e._v(" "),r("div",{staticClass:"fSearch-1"},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.cluesList()}}},[e._v("查 询")])],1)])],1),e._v(" "),r("div",{staticClass:"listTitle"},[r("i"),e._v(" "),r("span",[e._v("数据列表")])]),e._v(" "),r("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.list,border:""}},[r("el-table-column",{attrs:{prop:"serverName",label:"服务名称",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"price",label:"价格",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.price/100)+"元")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"服务类型",prop:"serverDetails"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.serverDetails,function(t){return r("span",{key:t.userType},[r("br"),e._v(" "),1==t.userType?r("span",[e._v("精准线索"),r("br"),r("br")]):e._e(),e._v(" "),2==t.userType?r("span",[e._v("精准到店"),r("br"),r("br")]):e._e(),e._v(" "),3==t.userType?r("span",[e._v("普通线索"),r("br"),r("br")]):e._e(),e._v(" "),4==t.userType?r("span",[e._v("普通到店"),r("br"),r("br")]):e._e()])})}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"ss",label:"总数"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.serverDetails,function(t){return r("span",{key:t.userType},[r("br"),e._v(" "),r("span",[e._v(e._s(t.serverNum)),r("br"),r("br")])])})}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"dd",label:"可用次数"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.serverDetails,function(t){return r("span",{key:t.userType},[r("br"),e._v(" "),r("span",[e._v(e._s(t.unuseNum)),r("br"),r("br")])])})}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"ee",label:"冻结次数"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.serverDetails,function(t){return r("span",{key:t.userType},[r("br"),e._v(" "),r("span",[e._v(e._s(t.freezeNum)),r("br"),r("br")])])})}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"createDate",label:"购买日期",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.handleDetails(t.$index,t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,background:"",layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),e._v(" "),r("div",{staticClass:"scrollKey",staticStyle:{display:"none"}}),e._v(" "),r("el-tab-pane",{attrs:{label:"服务介绍",name:"second"}},[1==e.step?r("div",[r("el-row",{attrs:{gutter:12}},e._l(e.systemServerList,function(t,a){return r("el-col",{key:a,staticStyle:{"margin-bottom":"12px"},attrs:{xs:24,sm:12,md:12,lg:12,xl:12}},[r("el-card",{attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("产品名称："+e._s(t.serverName))])]),e._v(" "),r("div",{staticClass:"text item"},[r("div",{staticClass:"serverListBox"},[r("p",{staticClass:"price"},[e._v("价格："+e._s(t.price/100)+"元")]),e._v(" "),r("p",[e._v("产品说明：")]),e._v(" "),r("p",{staticClass:"proInfo"},[r("span",{domProps:{innerHTML:e._s(t.ctx)}}),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),e._l(t.serverDetails,function(t){return r("span",{key:t.code},[e._v("\n                        "+e._s(t.serverNum)+"个\n                        "),e._l(e.user_type,function(a){return r("span",{key:a.userType},[e._v(e._s(a.code===t.userType?a.lableName:""))])}),e._v(" "+e._s(t.serverDesc?":":"")+"\n                        "+e._s(t.serverDesc)+"\n                        "),r("br"),e._v(" "),r("br")],2)})],2),e._v(" "),r("p",[r("el-button",{attrs:{size:"large",type:"success"},on:{click:function(r){return e.hurryBuy(t)}}},[e._v("立即购买")])],1)]),e._v(" "),r("div",{staticClass:"clearfix"})])])],1)}),1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.serviceTotal},on:{"current-change":e.handleServiceCurrentChange}})],1):e._e(),e._v(" "),2==e.step?r("div",{staticClass:"tepBox2",staticStyle:{"margin-top":"100px"}},[r("el-row",{attrs:{gutter:12}},[r("el-col",{attrs:{xs:24,sm:12,md:12,lg:8,xl:8}},[r("p",[r("el-radio",{attrs:{label:"WX"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("微信扫码支付")])],1),e._v(" "),r("img",{attrs:{src:e.userInfo.uploadUrl+e.payaccount.wxPayPic,alt:""}})]),e._v(" "),r("el-col",{attrs:{xs:24,sm:12,md:12,lg:8,xl:8}},[r("p",[r("el-radio",{attrs:{label:"ALI"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("支付宝扫码支付")])],1),e._v(" "),r("img",{attrs:{src:e.userInfo.uploadUrl+e.payaccount.aliPayPic,alt:""}})]),e._v(" "),r("el-col",{attrs:{xs:24,sm:12,md:12,lg:8,xl:8}},[r("p",{staticStyle:{"text-align":"left"}},[r("el-radio",{attrs:{label:"BANK"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("银行转账")])],1),e._v(" "),r("p",{staticStyle:{"text-align":"left"}},[e._v("开户行："+e._s(e.payaccount.bankName))]),e._v(" "),r("p",{staticStyle:{"text-align":"left"}},[e._v("开户账号："+e._s(e.payaccount.bankAcctNo))]),e._v(" "),r("p",{staticStyle:{"text-align":"left"}},[e._v("电话："+e._s(e.payaccount.payPhone))])])],1),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("el-row",{attrs:{gutter:12}},[r("el-col",{attrs:{xs:24,sm:12,md:12,lg:8,xl:8}},[r("p",[e._v("扫码支付完成,请点击下一步!")]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("el-button",{attrs:{size:"large",type:"success"},on:{click:function(t){e.step=1}}},[e._v("上一步")]),e._v(" "),r("el-button",{attrs:{size:"large",type:"success"},on:{click:function(t){return e.nextStep()}}},[e._v("下一步")])],1)],1)],1):e._e(),e._v(" "),3==e.step?r("div",[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[r("el-form-item",{attrs:{label:"支付方式：",prop:"payType"}},[r("el-radio",{attrs:{label:"WX"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("微信")]),e._v(" "),r("el-radio",{attrs:{label:"ALI"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("支付宝")]),e._v(" "),r("el-radio",{attrs:{label:"BANK"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},[e._v("银行卡转账")])],1),e._v(" "),r("el-form-item",{attrs:{label:"支付流水："}},[r("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入流水号"},model:{value:e.form.runingWater,callback:function(t){e.$set(e.form,"runingWater",t)},expression:"form.runingWater"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"购买服务：",prop:"serverType"}},[r("el-input",{staticStyle:{width:"80%"},attrs:{disabled:""},model:{value:e.form.serverType,callback:function(t){e.$set(e.form,"serverType",t)},expression:"form.serverType"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"支付金额：",prop:"payCount"}},[r("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入支付金额"},on:{input:e.limitMoney_input,keyup:e.inpnumup},model:{value:e.form.payCount,callback:function(t){e.$set(e.form,"payCount",t)},expression:"form.payCount"}},[r("template",{slot:"append"},[e._v("元")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"支付时间："}},[r("el-date-picker",{staticStyle:{width:"80%"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间","picker-options":e.minExecuteTime},model:{value:e.form.payTime,callback:function(t){e.$set(e.form,"payTime",t)},expression:"form.payTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"上传凭证：",prop:"sharePic"}},[r("MoreImgUpload",{attrs:{limitNumber:e.limitNumber,"file-list":e.fileList},model:{value:e.form.sharePic,callback:function(t){e.$set(e.form,"sharePic",t)},expression:"form.sharePic"}}),e._v(" "),r("p",{staticStyle:{color:"red"}},[e._v("最多上传5张凭证")])],1),e._v(" "),r("div",{staticStyle:{"margin-top":"60px"}},[r("el-form-item",{attrs:{align:"left"}},[r("el-button",{attrs:{type:"success"},on:{click:function(t){e.step=2}}},[e._v("返回")]),e._v(" "),r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.saveSubmit("form")}}},[e._v("保存")])],1)],1)],1)],1):e._e()])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"服务详情",visible:e.showReceipt,width:"30%"},on:{"update:visible":function(t){e.showReceipt=t}}},[e.serverDetail?r("span",[r("p",[e._v("产品名称："+e._s(e.serverDetail.serverName))]),e._v(" "),r("p",[e._v("价格："+e._s(e.serverDetail.price/100))]),e._v(" "),r("span",{domProps:{innerHTML:e._s(e.serverDetail.ctx)}}),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),e._l(e.serverDetail.serverDetails,function(t){return r("span",{key:t.code},[e._v("\n        "+e._s(t.serverNum)+"个\n        "),e._l(e.user_type,function(a){return r("span",{key:a.userType},[e._v(e._s(a.code===t.userType?a.lableName:""))])}),e._v(" "+e._s(t.serverDesc?":":"")+"\n        "+e._s(t.serverDesc)+"\n        "),r("br"),e._v(" "),r("br")],2)})],2):e._e(),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showReceipt=!1}}},[e._v("关闭")])],1)])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=10.eb1625460173686cb5a3.js.map